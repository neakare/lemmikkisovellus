{% extends "layout.html" %}

{% block title %}Lemmikkisovellus{% endblock %}

{% block content %}

  <h2>{{ pet.name }}</h2>
  
  {% for message in get_flashed_messages() %}
<p class="info">
  <b>{{ message }}</b>
</p>
{% endfor %}

  Eläinlaji: {{pet.species}}<br />
  Rotu: {{pet.breed}}<br/>
  Aktiivisuustaso: {{pet.activity}}<br/>
  Ruokahalu: {{pet.appetite}}<br/>
  Lisännyt: <a href="/user/{{ pet.user_id }}">{{ pet.username }}</a><br/>

  <p>
  {% if pet.has_image %}
  <img src="/image_pet/{{ pet.id }}" width="150" alt="Lemmikin {{ pet.name }} kuva"/><br/>
  {% endif %}
  
  {% if pet.user_id == session.user_id %}
  {% if pet.has_image %}
  <a href="/pet/add_image/{{ pet.id }}">Vaihda kuva</a> | 
  <a href="/remove/image_pet/{{ pet.id }}">Poista kuva</a>
  {% else %}
  <a href="/pet/add_image/{{ pet.id }}">Lisää kuva</a>
  {% endif %}
  </p>

  <p>
    <a href="/edit_pet/{{ pet.id }}">Muokkaa lemmikkiä</a> |
    <a href="/remove_pet/{{ pet.id }}">Poista lemmikki</a>
  </p>

  {% endif %}

  <hr />
  <h3>Kommentit</h3>
  {% for message in messages %}
  <div class="pet">
  <p id="{{ message.id }}">
    <a href="/user/{{ message.user_id }}">{{ message.username }}</a> ({{ message.sent_at }}):
  </p>
  <p>
    {{ message.content | show_lines }}
  </p>
  {% if message.user_id == session.user_id %}
  <p>
    <a href="/edit/{{ message.id }}">Muokkaa kommenttia</a> |
    <a href="/remove/{{ message.id }}">Poista kommentti</a>
  </p>
  {% endif %}
  </div>
  {% endfor %}

  {% if session.user_id %}
  <h3>Uusi kommentti</h3>
  Kommentin sallittu pituus on 1-5000 merkkiä.
  <form action="/new_message" method="post">
    <p>
      <label for="content">Kommentti</label>:<br />
      <textarea name="content" rows="5" cols="40"  maxlength="5000" required></textarea>
    </p>
    <input type="hidden" name="pet_id" value="{{ pet.id }}" />
    <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}" />
    <input type="submit" value="Lähetä" />
  </form>
  {% endif %}

  {% endblock %}